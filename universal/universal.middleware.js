"use strict";
import compose from 'composable-middleware';

const EnabledTablesForGET = ["address","air_segment","airlines","airport_city_mapping","airports","cabin_class","city_to_msa_mapping","company","compass_case","compass_case_event","compass_case_history","compass_case_owner","compass_case_priority","compass_case_purpose","compass_case_resolution","compass_case_status","compass_case_tag","compass_contact_person_type","compass_copy","compass_copy_block","compass_event","compass_event_direction","compass_event_disposition","compass_event_external_system","compass_event_feature_request","compass_event_gift_card","compass_event_next_steps","compass_event_payment_transaction","compass_event_person","compass_event_purpose","compass_event_resolution","compass_event_type","compass_event_upside_package","compass_exception","compass_exception_calculator_status","compass_exception_element","compass_exception_element_type","compass_feature_request","compass_group","compass_location","compass_navigator_group","compass_navigator_skill","compass_navigators","compass_organization","compass_permission","compass_person_lock","compass_queue","compass_queue_group","compass_queue_skill","compass_role","compass_role_permission","compass_skill","compass_tickets","credentials","email","equipment","fare_class_to_cabin","gift_card_transaction","hotel_blacklist","hotel_cancellation_policy","hotel_chain","hotel_charges","hotel_clusters","hotel_nightly_rate","hotel_partner","hotel_properties","hotel_segment","hotel_surcharge","hotel_value_add","hotels_str","loyalty_points","package_segment","partner_stage","passport","payment_card","payment_transaction","person","person_airlines","person_airport","person_company","person_hotel_chain","person_person_relationship","person_person_roles","person_preference","phone_number","phone_number_type","pnr_frequent_flyer","pnr_master","pnr_priced_itinerary","pnr_tickets","preference_category","preference_category_value","priority_hotels","referral","referral_type","status_programs","supplier_credit_status","supplier_credits","ticket_status","transaction","transaction_to_upside_segment","travel_status","upside_fees","upside_package","user","zip_to_msa_mapping"];
const EnabledTablesForPOST = ["address","air_segment","airlines","airport_city_mapping","airports","cabin_class","city_to_msa_mapping","company","compass_case","compass_case_event","compass_case_history","compass_case_owner","compass_case_priority","compass_case_purpose","compass_case_resolution","compass_case_status","compass_case_tag","compass_contact_person_type","compass_copy","compass_copy_block","compass_event","compass_event_direction","compass_event_disposition","compass_event_external_system","compass_event_feature_request","compass_event_gift_card","compass_event_next_steps","compass_event_payment_transaction","compass_event_person","compass_event_purpose","compass_event_resolution","compass_event_type","compass_event_upside_package","compass_exception","compass_exception_calculator_status","compass_exception_element","compass_exception_element_type","compass_feature_request","compass_group","compass_location","compass_navigator_group","compass_navigator_skill","compass_navigators","compass_organization","compass_permission","compass_person_lock","compass_queue","compass_queue_group","compass_queue_skill","compass_role","compass_role_permission","compass_skill","compass_tickets","credentials","email","equipment","fare_class_to_cabin","gift_card_transaction","hotel_blacklist","hotel_cancellation_policy","hotel_chain","hotel_charges","hotel_clusters","hotel_nightly_rate","hotel_partner","hotel_properties","hotel_segment","hotel_surcharge","hotel_value_add","hotels_str","loyalty_points","package_segment","partner_stage","passport","payment_card","payment_transaction","person","person_airlines","person_airport","person_company","person_hotel_chain","person_person_relationship","person_person_roles","person_preference","phone_number","phone_number_type","pnr_frequent_flyer","pnr_master","pnr_priced_itinerary","pnr_tickets","preference_category","preference_category_value","priority_hotels","referral","referral_type","status_programs","supplier_credit_status","supplier_credits","ticket_status","transaction","transaction_to_upside_segment","travel_status","upside_fees","upside_package","user","zip_to_msa_mapping"];
const EnabledTablesForPATCH = ["address","air_segment","airlines","airport_city_mapping","airports","cabin_class","city_to_msa_mapping","company","compass_case","compass_case_event","compass_case_history","compass_case_owner","compass_case_priority","compass_case_purpose","compass_case_resolution","compass_case_status","compass_case_tag","compass_contact_person_type","compass_copy","compass_copy_block","compass_event","compass_event_direction","compass_event_disposition","compass_event_external_system","compass_event_feature_request","compass_event_gift_card","compass_event_next_steps","compass_event_payment_transaction","compass_event_person","compass_event_purpose","compass_event_resolution","compass_event_type","compass_event_upside_package","compass_exception","compass_exception_calculator_status","compass_exception_element","compass_exception_element_type","compass_feature_request","compass_group","compass_location","compass_navigator_group","compass_navigator_skill","compass_navigators","compass_organization","compass_permission","compass_person_lock","compass_queue","compass_queue_group","compass_queue_skill","compass_role","compass_role_permission","compass_skill","compass_tickets","credentials","email","equipment","fare_class_to_cabin","gift_card_transaction","hotel_blacklist","hotel_cancellation_policy","hotel_chain","hotel_charges","hotel_clusters","hotel_nightly_rate","hotel_partner","hotel_properties","hotel_segment","hotel_surcharge","hotel_value_add","hotels_str","loyalty_points","package_segment","partner_stage","passport","payment_card","payment_transaction","person","person_airlines","person_airport","person_company","person_hotel_chain","person_person_relationship","person_person_roles","person_preference","phone_number","phone_number_type","pnr_frequent_flyer","pnr_master","pnr_priced_itinerary","pnr_tickets","preference_category","preference_category_value","priority_hotels","referral","referral_type","status_programs","supplier_credit_status","supplier_credits","ticket_status","transaction","transaction_to_upside_segment","travel_status","upside_fees","upside_package","user","zip_to_msa_mapping"];
const EnabledTablesForDELETE = [];


export function checkEnabledTables(method) {

  var tables = method=='GET'? EnabledTablesForGET: method=='POST'? EnabledTablesForPOST: method=='PATCH'?EnabledTablesForPATCH: method=='DELETE' ? EnabledTablesForPATCH:[]

  return compose()
    .use(function(req,res,next){
      if(!!~tables.indexOf(req.params.model)){ return next();}
      return res.status(403).end();
    })
}
